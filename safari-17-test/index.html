<!DOCTYPE html>

<body>
<img src="testimg.heic" width="300" height="300">
<div id="result"></div>
</body>

<script>
function testHeicSupport() {
  const testImage = "data:image/heic;base64,AAAAHGZ0eXBoZWljAAAAAG1pZjFoZWljbWlhZgAAAYFtZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAANGlsb2MAAAAAREAAAgABAAAAAAGlAAEAAAAAAAAAHwACAAAAAAHEAAEAAAAAAAAA3AAAADhpaW5mAAAAAAACAAAAFWluZmUCAAAAAAEAAGh2YzEAAAAAFWluZmUCAAABAAIAAEV4aWYAAAAAwGlwcnAAAACiaXBjbwAAAHZodmNDAQQIAAAAAAAAAAAAHvAA/P74+AAADwMgAAEAF0ABDAH//wQIAAADAJ04AAADAAAeugJAIQABACpCAQEECAAAAwCdOAAAAwAAHrAggQWW6kkka5uAhoCCAAADAAIAAAMAAhAiAAEAB0QBwXKwIkAAAAAUaXNwZQAAAAAAAABAAAAAQAAAABBwaXhpAAAAAAMICAgAAAAWaXBtYQAAAAAAAAABAAEDgQKDAAAAGmlyZWYAAAAAAAAADmNkc2MAAgABAAEAAAEDbWRhdAAAABsoAa8GOFtzv/Lf4AJ/r/Gz///upykP+ITjlfgAAAAASUkqAAgAAAAGABIBAwABAAAAAQAAABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAwAAADEBAgARAAAAZgAAAGmHBAABAAAAeAAAAAAAAACjkwAA6AMAAKOTAADoAwAAcGFpbnQubmV0IDUuMC4xMQAABQAAkAcABAAAADAyMzABoAMAAQAAAAEAAAACoAQAAQAAAEAAAAADoAQAAQAAAEAAAAAFoAQAAQAAALoAAAAAAAAAAgABAAIABAAAAFI5OAACAAcABAAAADAxMDAAAAAA";
  return new Promise(function(resolve, reject) {
    var image = new Image();
    image.addEventListener('load', resolve);
    image.addEventListener('error', reject);
    image.src = testImage;
  });
}

testHeicSupport()
    .then((_) => document.getElementById("result").innerText = "yep")
    .catch((_) => document.getElementById("result").innerText = "nope");
</script>

</html>
